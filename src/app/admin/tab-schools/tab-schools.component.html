<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Escuelas</ion-title>
    @if(isLoading) {
      <ion-progress-bar color="warning" type="indeterminate"></ion-progress-bar>
    }
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list>
    @for(school of schools; track school.id) {
      <ion-item-sliding class="sliding-item-card" #slidingItem>

        <ion-item class="custom-item">
          <ion-label>
            <h2>{{ school.nombre }}</h2>
            <p>{{ school.cct }}</p>
          </ion-label>
          <ion-chip>PIN: <strong>{{ school.pin }}</strong></ion-chip>
        </ion-item>

        <ion-item-options side="end">

          <ion-item-option id="edit-{{ school.id }}">
            <ion-icon slot="icon-only" name="create"></ion-icon>
          </ion-item-option>

          <ion-item-option id="delete-{{ school.id }}" color="danger">
            <ion-icon slot="icon-only" name="trash"></ion-icon>
          </ion-item-option>

          <ion-action-sheet
           trigger="delete-{{ school.id }}"
           header="EstÃ¡s a punto de eliminar"
           subHeader="{{ school.nombre }}"
           [buttons]="actionSheetButtons"
           (didDismiss)="onDeleteSchool($event, slidingItem, school)"
          >
          </ion-action-sheet>

        </ion-item-options>
      </ion-item-sliding>
      <ion-modal
       trigger="edit-{{school.id}}"
       [initialBreakpoint]="0.75"
       [breakpoints]="[0, 0.25, 0.50, 0.75, 1]"
       (didDismiss)="onModalDismiss($event, slidingItem)"
      >
        <ng-template>

          <ion-header>
            <ion-toolbar>
              <ion-buttons slot="start">
                <ion-button (click)="closeModal('edit-'+school.id)">Cancelar</ion-button>
              </ion-buttons>
              <ion-title>Editar Escuela</ion-title>
              <ion-buttons slot="end">
                <ion-button [strong]="true">Guardar</ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-header>

          <ion-content>
            <h2>{{ school.nombre }}</h2>
          </ion-content>

        </ng-template>
      </ion-modal>
    }
  </ion-list>

  <ion-toast
   cssClass="page__toast"
   [message]="toastMessage"
   [isOpen]="isToastOpen"
   [duration]="5000"
   (didDismiss)="setOpenToast(false)"
  ></ion-toast>

</ion-content>

<ion-modal
 trigger="new-school-btn"
 [initialBreakpoint]="0.75"
 [breakpoints]="[0, 0.25, 0.50, 0.75, 1]"
>
  <ng-template>

    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="closeModal('new-school-btn')">Cancelar</ion-button>
        </ion-buttons>
        <ion-title>Nueva Escuela</ion-title>
        <ion-buttons slot="end">
          <ion-button [strong]="true">Guardar</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content>

    </ion-content>

  </ng-template>
</ion-modal>

<ion-fab slot="fixed" vertical="bottom" horizontal="end">
  <ion-fab-button size="small" id="new-school-btn">
    <ion-icon name="add"></ion-icon>
  </ion-fab-button>
</ion-fab>
