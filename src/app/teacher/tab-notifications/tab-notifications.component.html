<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Notificaciones</ion-title>
    @if(isLoading) {
      <ion-progress-bar type="indeterminate" color="warning"></ion-progress-bar>
    }
  </ion-toolbar>
</ion-header>

<ion-content>
  @if(studentGroups.length === 0 && !isLoading) {
    <div class="center-box">
      <p>Para crear notificaciones primero debes registrar a los alumnos y grupos de tu Centro de Trabajo.</p>
    </div>
  }
  <ion-accordion-group expand="inset">
    @for(group of studentGroups; track group.gid) {
      <ion-accordion value="{{ group.grado }}{{ group.letra }}" toggleIconSlot="start">
        <ion-item slot="header" color="light">
          <ion-label>Grupo {{ group.grado }}° "{{ group.letra }}"</ion-label>
        </ion-item>
        <div slot="content">
          @if (studentsListByGroup(group.gid).length === 0) {
            <ion-label>
              <p>No hay alumnos en este grupo.</p>
            </ion-label>
          }
          @else {
            @for(student of studentsListByGroup(group.gid); track student.id) {
              <ion-item-sliding>
                <ion-item>
                  <ion-label>
                    <h2>{{ student.nombreCompleto }}</h2>
                  </ion-label>
                </ion-item>
                <ion-item-options side="end">
                  <ion-item-option
                   color="tertiary"
                   id="absence-{{ student.id }}"
                  >
                    <ion-icon slot="icon-only" name="calendar-number"></ion-icon>
                  </ion-item-option>
                  <ion-item-option
                   color="primary"
                   id="homework-{{ student.id }}"
                  >
                    <ion-icon slot="icon-only" name="book"></ion-icon>
                  </ion-item-option>
                  <ion-item-option
                   color="secondary"
                   id="misconduct-{{ student.id }}"
                  >
                    <ion-icon slot="icon-only" name="sad"></ion-icon>
                  </ion-item-option>
                </ion-item-options>
              </ion-item-sliding>

              <!-- Modal (Faltas) -->
              <ion-modal
               trigger="absence-{{ student.id }}"
               [initialBreakpoint]="initialBreakpoint"
               [breakpoints]="breakpoints"
               #addAbsenseModal
              >
                <ng-template>
                  <ion-header>
                    <ion-toolbar>
                      <ion-buttons slot="start">
                        <ion-button>
                          Cancelar
                        </ion-button>
                      </ion-buttons>
                      <ion-title>Inasistencia</ion-title>
                      <ion-buttons slot="end">
                        <ion-button
                         [strong]="true"
                        >
                          Agregar
                        </ion-button>
                      </ion-buttons>
                    </ion-toolbar>
                  </ion-header>
                </ng-template>
              </ion-modal>

              <!-- Modal (Incumplimiento de tareas) -->
              <ion-modal
               trigger="homework-{{ student.id }}"
               [initialBreakpoint]="initialBreakpoint"
               [breakpoints]="breakpoints"
               #addHomeworkModal
              >
                <ng-template>
                  <ion-header>
                    <ion-toolbar>
                      <ion-buttons slot="start">
                        <ion-button>
                          Cancelar
                        </ion-button>
                      </ion-buttons>
                      <ion-title>Incumplimiento</ion-title>
                      <ion-buttons slot="end">
                        <ion-button
                         [strong]="true"
                        >
                          Agregar
                        </ion-button>
                      </ion-buttons>
                    </ion-toolbar>
                  </ion-header>
                </ng-template>
              </ion-modal>

              <!-- Modal (Indisciplina) -->
              <ion-modal
               trigger="misconduct-{{ student.id }}"
               [initialBreakpoint]="initialBreakpoint"
               [breakpoints]="breakpoints"
               #addMisconductModal
              >
                <ng-template>
                  <ion-header>
                    <ion-toolbar>
                      <ion-buttons slot="start">
                        <ion-button>
                          Cancelar
                        </ion-button>
                      </ion-buttons>
                      <ion-title>Indisciplina</ion-title>
                      <ion-buttons slot="end">
                        <ion-button
                         [strong]="true"
                        >
                          Agregar
                        </ion-button>
                      </ion-buttons>
                    </ion-toolbar>
                  </ion-header>
                </ng-template>
              </ion-modal>
            }
          }
        </div>
      </ion-accordion>
    }
  </ion-accordion-group>
</ion-content>



<!--
  <ion-accordion value="1A" toggleIconSlot="start">
    <ion-item slot="header" color="light">
      <ion-label>Grupo 1° "A"</ion-label>
      <ion-button shape="round" (click)="onAddStudent($event)">
        <ion-icon slot="icon-only" name="person-add"></ion-icon>
      </ion-button>
    </ion-item>
    <div class="ion-padding" slot="content">
      No hay alumnos en este grupo.
    </div>
  </ion-accordion>
-->
